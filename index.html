<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2025 Year-end Ball Ticket</title>

<style>
  body {
    margin: 0;
    font-family: "Pretendard","Noto Sans KR", sans-serif;
    background: linear-gradient(160deg, #210035, #12001f, #080013);
    color: #fff;
    padding: 18px;
  }

  .card {
    background: rgba(255,255,255,0.07);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 18px;
    padding: 22px;
    margin-bottom: 24px;
    backdrop-filter: blur(12px);
    box-shadow: 0 0 15px rgba(140, 53, 255, 0.2);
  }

  h1 { text-align:center; margin-bottom:6px; }
  .sub { text-align:center; opacity:0.75; margin-bottom:25px; }

  input {
    width: 100%;
    padding: 14px;
    border-radius: 12px;
    border: none;
    outline: none;
    background: rgba(255,255,255,0.12);
    color: #fff;
    font-size: 16px;
  }

  button {
    width: 100%;
    padding: 14px;
    border: none;
    border-radius: 12px;
    background: linear-gradient(135deg, #a64bff, #7a33ff);
    color: white;
    font-size: 17px;
    margin-top: 14px;
    font-weight: 600;
    box-shadow: 0 0 10px rgba(163, 76, 255, 0.4);
    cursor: pointer;
  }

  .admin-btn {
    background: transparent;
    border: 1px solid rgba(255,255,255,0.25);
    margin-top: 22px;
  }

  .ticket-box {
    margin-top: 16px;
    background: rgba(255,255,255,0.12);
    padding: 18px;
    border-radius: 14px;
    text-align: center;
  }

  #adminArea { display:none; }

  .ticket-card {
    background: rgba(255,255,255,0.09);
    border-radius: 14px;
    padding: 16px;
    margin-bottom: 14px;
  }

  .ticket-title { font-size:17px; font-weight:600; }
  .ticket-time { opacity:0.7; font-size:14px; margin-bottom:8px; }

  .badge {
    display:inline-block;
    padding:4px 10px;
    border-radius:10px;
    font-size:13px;
    margin-bottom:8px;
  }
  .done { background:#8f4bff; color:#fff; }
  .notyet { background:#333; color:#ddd; }

  .row-btns {
    display:flex;
    gap:8px;
    margin-top:8px;
  }

  .subbtn {
    flex:1;
    padding:10px;
    border-radius:10px;
    border:none;
    font-size:14px;
    cursor:pointer;
    background:rgba(255,255,255,0.1);
    color:#fff;
  }

  .copy-btn { background: linear-gradient(135deg,#ff7de1,#d146ff); }
  .delete-btn { background:#ff3f6c; }
</style>
</head>

<body>

<h1>ğŸ’œ 2025 Year-end Ball</h1>
<p class="sub">í‹°ì¼“ ë°œê¸‰ Â· ê´€ë¦¬ì ì‹œìŠ¤í…œ(ìµœì¢… í†µí•©íŒ)</p>

<!-- í‹°ì¼“ ë°œê¸‰ -->
<div class="card">
  <h2 style="margin-top:0;">ğŸ« í‹°ì¼“ ë°œê¸‰</h2>
  <input id="buyer" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
  <button onclick="makeTicket()">í‹°ì¼“ ë°œê¸‰í•˜ê¸°</button>

  <div id="ticketBox" class="ticket-box" style="display:none;">
    <h3>ğŸŸ ë°œê¸‰ëœ í‹°ì¼“</h3>
    <p id="ticketName"></p>
    <p id="ticketCode" style="font-size:22px; color:#d7b4ff;"></p>
  </div>
</div>

<button class="admin-btn" onclick="toggleAdmin()">ğŸ” ê´€ë¦¬ì ëª¨ë“œ</button>

<!-- ê´€ë¦¬ì ì˜ì—­ -->
<div id="adminArea" class="card">
  <h2>ğŸ›  ê´€ë¦¬ì ì˜ì—­</h2>

  <input id="search" placeholder="ì´ë¦„ ë˜ëŠ” ì½”ë“œ ê²€ìƒ‰" oninput="renderAdmin()">

  <h3>ì´ í‹°ì¼“: <span id="count">0</span></h3>

  <button onclick="exportTickets()">ğŸ“¤ í‹°ì¼“ ë°ì´í„° ì €ì¥(ë‹¤ìš´ë¡œë“œ)</button>
  <button onclick="importTickets()">ğŸ“¥ í‹°ì¼“ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</button>
  <input type="file" id="fileInput" style="display:none;" accept=".json">

  <div id="adminList" style="margin-top:16px;"></div>
</div>

<script>
/* ============================
   í‹°ì¼“ ë°œê¸‰
============================ */
function makeTicket() {
  const name = buyer.value.trim();
  if (!name) return alert("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");

  const code = "BALL-" + Math.random().toString(36).substring(2, 10).toUpperCase();
  const time = new Date().toLocaleString();

  ticketName.innerText = `êµ¬ë§¤ì: ${name}`;
  ticketCode.innerText = code;
  ticketBox.style.display = "block";

  let list = JSON.parse(localStorage.getItem("tickets") || "[]");
  list.push({ name, code, time, checked: false });
  localStorage.setItem("tickets", JSON.stringify(list));

  renderAdmin();
}

/* ê´€ë¦¬ì ON/OFF */
function toggleAdmin() {
  const a = document.getElementById("adminArea");
  a.style.display = a.style.display === "none" ? "block" : "none";
  renderAdmin();
}

/* í‹°ì¼“ ìƒíƒœ í† ê¸€ */
function toggleCheck(i) {
  let list = JSON.parse(localStorage.getItem("tickets") || "[]");
  list[i].checked = !list[i].checked;
  localStorage.setItem("tickets", JSON.stringify(list));
  renderAdmin();
}

/* í‹°ì¼“ ë³µì‚¬ */
function copyTicket(i) {
  let list = JSON.parse(localStorage.getItem("tickets") || "[]");
  navigator.clipboard.writeText(list[i].code);
  alert("í‹°ì¼“ ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
}

/* í‹°ì¼“ ì‚­ì œ */
function deleteTicket(i) {
  if (!confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;

  let list = JSON.parse(localStorage.getItem("tickets") || "[]");
  list.splice(i, 1);

  localStorage.setItem("tickets", JSON.stringify(list));
  renderAdmin();
}

/* ê´€ë¦¬ì ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ */
function renderAdmin() {
  const list = JSON.parse(localStorage.getItem("tickets") || "[]");
  const q = (document.getElementById("search").value || "").toLowerCase();
  const adminList = document.getElementById("adminList");

  document.getElementById("count").innerText = list.length;
  adminList.innerHTML = "";

  list.forEach((t, i) => {
    if (q && !t.name.toLowerCase().includes(q) && !t.code.toLowerCase().includes(q)) return;

    const card = document.createElement("div");
    card.className = "ticket-card";

    card.innerHTML = `
      <div class="ticket-title">${t.name} Â· ${t.code}</div>
      <div class="ticket-time">${t.time}</div>

      <span class="badge ${t.checked ? "done" : "notyet"}">
        ${t.checked ? "ì…ì¥ ì™„ë£Œ" : "ë¯¸ì…ì¥"}
      </span>

      <div class="row-btns">
        <button class="subbtn copy-btn" onclick="copyTicket(${i})">ë³µì‚¬</button>
        <button class="subbtn" onclick="toggleCheck(${i})">ì²´í¬</button>
        <button class="subbtn delete-btn" onclick="deleteTicket(${i})">ì‚­ì œ</button>
      </div>
    `;

    adminList.appendChild(card);
  });
}

/* ============================
   ë°ì´í„° ë‹¤ìš´ë¡œë“œ
============================ */
function exportTickets() {
  const data = localStorage.getItem("tickets") || "[]";
  const blob = new Blob([data], { type: "application/json" });

  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "tickets_backup.json";
  a.click();
}

/* ============================
   ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
============================ */
function importTickets() {
  const input = document.getElementById("fileInput");
  input.click();

  input.onchange = (e) => {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = (evt) => {
      try {
        const json = JSON.parse(evt.target.result);
        localStorage.setItem("tickets", JSON.stringify(json));
        alert("ë°ì´í„°ê°€ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤!");
        renderAdmin();
      } catch {
        alert("ì˜¬ë°”ë¥¸ JSON íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤.");
      }
    };

    reader.readAsText(file);
  };
}

renderAdmin();
</script>

</body>
</html>